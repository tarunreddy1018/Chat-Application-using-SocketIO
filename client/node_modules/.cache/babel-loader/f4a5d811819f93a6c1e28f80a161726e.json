{"ast":null,"code":"import _toConsumableArray from\"C:\\\\Clone Projects\\\\Chat-Application-using-SocketIO-master\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"C:\\\\Clone Projects\\\\Chat-Application-using-SocketIO-master\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import queryString from'query-string';import io from'socket.io-client';import ScrollToBottom from'react-scroll-to-bottom';import{Redirect}from'react-router-dom';import InfoBar from'../InfoBar/InfoBar';import Messages from'../Messages/Messages';import Input from'../Input/Input';import UsersList from'../UsersList/UsersList';import'./Chat.css';var socket;var Chat=function Chat(_ref){var location=_ref.location;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),name=_useState2[0],setName=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),room=_useState4[0],setRoom=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),message=_useState6[0],setMessage=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),messages=_useState8[0],setMessages=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),users=_useState10[0],setUsers=_useState10[1];var _useState11=useState(''),_useState12=_slicedToArray(_useState11,2),errorMessage=_useState12[0],setErrorMessage=_useState12[1];var ENDPOINT='https://chat-app-1996.herokuapp.com/';useEffect(function(){var _queryString$parse=queryString.parse(location.search),name=_queryString$parse.name,room=_queryString$parse.room;socket=io(ENDPOINT);setName(name);setRoom(room);socket.emit('join',{name:name,room:room});socket.on('errorMessage',function(error){if(error.id===socket.id){setErrorMessage(error.errorMessage);socket.emit('disconnect');socket.off();}});socket.on('roomInfo',function(roomInfo){setUsers(roomInfo.users);setMessages(roomInfo.messages);});return function(){socket.emit('disconnect');socket.off();};},[ENDPOINT,location.search]);useEffect(function(){socket.on('message',function(message){setMessages([].concat(_toConsumableArray(messages),[message]));});},[messages]);var sendMessage=function sendMessage(event){event.preventDefault();if(message){socket.emit('sendMessage',room,name,message,function(){return setMessage('');});}};var res=null;if(errorMessage!==''){res=React.createElement(Redirect,{to:{pathname:'/',errorMessage:errorMessage}});}else{res=React.createElement(\"div\",{className:\"outerContainer\"},React.createElement(\"div\",{className:\"innerContainer\"},React.createElement(\"div\",{className:\"container\"},React.createElement(InfoBar,{room:room}),React.createElement(Messages,{messages:messages,name:name}),React.createElement(Input,{message:message,setMessage:setMessage,sendMessage:sendMessage})),React.createElement(\"div\",{className:\"onlineList\"},React.createElement(\"div\",{className:\"heading\"},React.createElement(\"h2\",null,\"Users Online\")),React.createElement(ScrollToBottom,{className:\"scrollBottom\"},React.createElement(\"div\",{className:\"container2\"},React.createElement(UsersList,{users:users}))))));}return res;};export default Chat;","map":{"version":3,"sources":["C:/Clone Projects/Chat-Application-using-SocketIO-master/client/src/components/Chat/Chat.js"],"names":["React","useEffect","useState","queryString","io","ScrollToBottom","Redirect","InfoBar","Messages","Input","UsersList","socket","Chat","location","name","setName","room","setRoom","message","setMessage","messages","setMessages","users","setUsers","errorMessage","setErrorMessage","ENDPOINT","parse","search","emit","on","error","id","off","roomInfo","sendMessage","event","preventDefault","res","pathname"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport queryString from 'query-string'\nimport io from 'socket.io-client';\nimport ScrollToBottom from 'react-scroll-to-bottom';\nimport { Redirect } from 'react-router-dom';\n\nimport InfoBar from '../InfoBar/InfoBar';\nimport Messages from '../Messages/Messages';\nimport Input from '../Input/Input';\nimport UsersList from '../UsersList/UsersList';\n\nimport './Chat.css';\n\nvar socket;\n\nconst Chat = ({ location }) => {\n    const [name, setName] = useState('');\n    const [room, setRoom] = useState('');\n    const [message, setMessage] = useState('');\n    const [messages, setMessages] = useState([]);\n    const [users, setUsers] = useState([]);\n    const [errorMessage, setErrorMessage] = useState('');\n\n    const ENDPOINT = 'https://chat-app-1996.herokuapp.com/';\n\n    useEffect(() => {\n        const { name, room } = queryString.parse(location.search);\n\n        socket = io(ENDPOINT);\n\n        setName(name);\n        setRoom(room);\n\n        socket.emit('join', { name, room });\n\n        socket.on('errorMessage', (error) => {\n            if(error.id === socket.id) {\n                setErrorMessage(error.errorMessage);\n                socket.emit('disconnect');\n                socket.off();\n            }\n        });\n\n        socket.on('roomInfo', (roomInfo) => {\n            setUsers(roomInfo.users);\n            setMessages(roomInfo.messages);\n        });\n\n        return () => {\n            socket.emit('disconnect');\n            socket.off();\n        }\n    }, [ENDPOINT, location.search]);\n\n    useEffect(() => {\n        socket.on('message', (message) => {\n            setMessages([...messages, message]);\n        });\n    }, [messages]);\n\n    const sendMessage = (event) => {\n        event.preventDefault();\n\n        if (message) {\n            socket.emit('sendMessage', room, name , message, () => setMessage(''));\n        }\n    };\n\n    let res = null;\n    if(errorMessage !== '') {\n        res = (\n                <Redirect to={{\n                            pathname: '/',\n                            errorMessage: errorMessage\n                }} />\n        );\n    }\n    else {\n        res = (\n            <div className=\"outerContainer\">\n                <div className=\"innerContainer\">\n                    <div className=\"container\">\n                        <InfoBar room={room} />\n                        <Messages messages={messages} name={name} />\n                        <Input message={message} setMessage={setMessage} sendMessage={sendMessage} />\n                    </div>\n                    <div className=\"onlineList\">\n                        <div className=\"heading\">\n                            <h2>Users Online</h2>\n                        </div>\n                        <ScrollToBottom className=\"scrollBottom\">\n                            <div className=\"container2\">\n                                <UsersList users={users} />\n                            </div>\n                        </ScrollToBottom>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n    return res;\n};\n\nexport default Chat;"]},"metadata":{},"sourceType":"module"}